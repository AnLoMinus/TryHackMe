![image](https://user-images.githubusercontent.com/51442719/198373510-b66a65a8-8df8-4125-bef0-b0dcac0f58d8.png)

# [PowerShell for Pentesters](https://tryhackme.com/room/powershellforpentesters)
#### This room covers the principle uses of PowerShell in Penetration Tests. Interacting with files, scanning the network and system enumeration are covered.

- [Task 1  Intro](#)
- [Task 2  Manipulating files](#)
- [Task 3  Downloading files](#)
- [Task 4  System Reconnaissance](#)
- [Task 5  Network Reconnaissance](#)
- [Task 6  Using PowerView](#)

---

# Task 1  Intro

---

# Task 2  Manipulating files

---

# Task 3  Downloading files

There are numerous ways to download files from a remote server using PowerShell. One of the quickest ways can be seen below. This will connect to the remote host (10.0.2.8 in this case) and download `themeterpreter-64.ps1`. The file is saved as “`meterpreter.ps1`”.



The screenshot below shows a sample lab setup used with Kali running a Python HTTP server on port 8888 (python3 -m http.server 8888).

![image](https://user-images.githubusercontent.com/51442719/198377051-3c893912-6b56-447c-886f-8765d3a477a0.png)

Once the script has been downloaded, you may run into the first related to PowerShell: ExecutionPolicy. It is important to note that, as Microsoft clearly states in the related documentation, “`ExecutionPolicy`” is NOT a security feature. It merely functions as an added safety measure and can be bypassed by the user.

![image](https://user-images.githubusercontent.com/51442719/198377120-87559081-f74b-4ee5-84f9-afab7aa243de.png)

The current state of the ExecutionPolicy configuration can be seen using “`Get-ExecutionPolicy -list`”

Execution policies can have seven different values;

- `AllSigned`: Scripts can run but require all scripts to be signed by a trusted publisher.
- `Bypass`: All scripts can run, and no warnings or prompts will be displayed.
- `Default`: This refers to “restricted” for Windows clients and “RemoteSigned” for Windows servers.
- `RemoteSigned`: Scripts can run, and this does not require local scripts to be digitally signed.
- `Restricted`: The default configuration for Windows clients. Allows individual commands to run, does not allow scripts.
- `Undefined`: This shows that no specific execution policy was set. This means default execution policies will be enforced.
- `Unrestricted`: Most scripts will run.

As mentioned earlier, ExecutionPolicy is not a security feature and can be bypassed by users. The user has several alternatives to bypass the ExecutionPolicy; however, some methods may require the user to have administrator account privileges.

The most common way to bypass execution policy can be seen below:

![image](https://user-images.githubusercontent.com/51442719/198377364-1ecb188d-2eb5-48a4-9e55-db4f1579284c.png)

Another option could be to use “`Set-ExecutionPolicy Bypass`” with the scope set for the process. The “`-scope`” parameter will set the execution policy only for the current PowerShell session and will go back to the initial settings once the PowerShell session is closed.

![image](https://user-images.githubusercontent.com/51442719/198377457-0dc6382f-ea13-4b8b-88ec-1b817fe8949a.png)

Another easy way to download files from a remote server is to use the “`Invoke-WebRequest`” command.

![image](https://user-images.githubusercontent.com/51442719/198377496-4e38ecd1-2b71-4869-af3b-c9aefdfd9567.png)

---

# Task 4  System Reconnaissance

---

# Task 5  Network Reconnaissance

---

# Task 6  Using PowerView

---

